scale_y_continuous(limits = c(0,5), breaks = seq(0,5,2)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Number", x="",
title = "First glance to ic after [...] glances to other AOIs\nafter start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_nth_gaze_to_ic_dot <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_nth_gaze_to_ic_dot.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_nth_gaze_to_ic_box #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_nth_gaze_to_ic <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_nth_gaze_to_ic) %>%
dplyr::rename(score = TC10_nth_gaze_to_ic) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_nth_gaze_to_ic <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_nth_gaze_to_ic) %>%
dplyr::rename(score = TC12_nth_gaze_to_ic) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_nth_gaze_to_ic <- bind_rows(TO_TC10_ic_nth_gaze_to_ic, TO_TC12_ic_nth_gaze_to_ic) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_nth_gaze_to_ic = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_nth_gaze_to_ic, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 5),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 5),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_nth_gaze_to_ic) +
scale_y_continuous(limits = c(0,5), breaks = seq(0,5,2)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Number", x="",
title = "First glance to ic after [...] glances to other AOIs\nafter start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_nth_gaze_to_ic_box <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_nth_gaze_to_ic_box.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_glance_allocation_time #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_glance_allocation_time <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_ic_glance_allocation_time) %>%
dplyr::rename(score = TC10_ic_glance_allocation_time) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_glance_allocation_time <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_ic_glance_allocation_time) %>%
dplyr::rename(score = TC12_ic_glance_allocation_time) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_glance_allocation_time <- bind_rows(TO_TC10_ic_glance_allocation_time, TO_TC12_ic_glance_allocation_time) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_glance_allocation_time = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_glance_allocation_time, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
geom_rect(aes(xmin = 0.505, xmax = 1.505, ymin = 19.94, ymax = 20.0),
fill = scales::alpha("red", 0.8)) +
geom_rect(aes(xmin = 1.505, xmax = 2.505, ymin = 5.97, ymax = 6.03),
fill = scales::alpha("red", 0.8)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_glance_allocation_time) +
scale_y_continuous(limits = c(0,20), breaks = seq(0,20,5)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Time [s]", x="",
title = "Glance allocation time to ic after start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_glance_allocation_time <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_glance_allocation_time.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_n_glances_after_start_dot #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_n_glances_after_start <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_ic_n_glances_after_start) %>%
dplyr::rename(score = TC10_ic_n_glances_after_start) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_n_glances_after_start <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_ic_n_glances_after_start) %>%
dplyr::rename(score = TC12_ic_n_glances_after_start) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_n_glances_after_start <- bind_rows(TO_TC10_ic_n_glances_after_start, TO_TC12_ic_n_glances_after_start) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_n_glances_after_start = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_n_glances_after_start, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 7),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 7),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
geom_violin(fill= "transparent") +
geom_dotplot(binaxis = 'y', stackdir = 'center',
stackratio=1.3, dotsize=0.2, binwidth = 0.5) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_n_glances_after_start) +
scale_y_continuous(limits = c(0,7), breaks = seq(0,7,2)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Number of glances", x="",
title = "Number of glances to ic after start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_n_glances_after_start_dot <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_n_glances_after_start_dot.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_n_glances_after_start_box #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_n_glances_after_start <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_ic_n_glances_after_start) %>%
dplyr::rename(score = TC10_ic_n_glances_after_start) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_n_glances_after_start <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_ic_n_glances_after_start) %>%
dplyr::rename(score = TC12_ic_n_glances_after_start) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_n_glances_after_start <- bind_rows(TO_TC10_ic_n_glances_after_start, TO_TC12_ic_n_glances_after_start) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_n_glances_after_start = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_n_glances_after_start, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 8),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 8),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_n_glances_after_start) +
scale_y_continuous(limits = c(0,8), breaks = seq(0,8,5)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Number of glances", x="",
title = "Number of glances to ic after start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_n_glances_after_start_box <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_n_glances_after_start_box.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_total_duration #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_total_duration <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_ic_total_duration) %>%
dplyr::rename(score = TC10_ic_total_duration) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_total_duration <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_ic_total_duration) %>%
dplyr::rename(score = TC12_ic_total_duration) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_total_duration <- bind_rows(TO_TC10_ic_total_duration, TO_TC12_ic_total_duration) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_total_duration = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_total_duration, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
geom_rect(aes(xmin = 0.505, xmax = 1.505, ymin = 19.94, ymax = 20.0),
fill = scales::alpha("red", 0.8)) +
geom_rect(aes(xmin = 1.505, xmax = 2.505, ymin = 5.97, ymax = 6.03),
fill = scales::alpha("red", 0.8)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_total_duration) +
scale_y_continuous(limits = c(0,20), breaks = seq(0,20,5)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Duration [s]", x="",
title = "Total duration: Eyes on ic after start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_total_duration <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_total_duration.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_mean_duration #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_mean_duration <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_ic_mean_duration) %>%
dplyr::rename(score = TC10_ic_mean_duration) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_mean_duration <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_ic_mean_duration) %>%
dplyr::rename(score = TC12_ic_mean_duration) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_mean_duration <- bind_rows(TO_TC10_ic_mean_duration, TO_TC12_ic_mean_duration) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_mean_duration = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_mean_duration, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
geom_rect(aes(xmin = 0.505, xmax = 1.505, ymin = 19.94, ymax = 20.0),
fill = scales::alpha("red", 0.8)) +
geom_rect(aes(xmin = 1.505, xmax = 2.505, ymin = 5.97, ymax = 6.03),
fill = scales::alpha("red", 0.8)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_mean_duration) +
scale_y_continuous(limits = c(0,20), breaks = seq(0,20,5)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Duration [s]", x="",
title = "Mean duration: Eyes on ic after start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_mean_duration <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_mean_duration.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_max_duration #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_max_duration <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_ic_max_duration) %>%
dplyr::rename(score = TC10_ic_max_duration) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_max_duration <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_ic_max_duration) %>%
dplyr::rename(score = TC12_ic_max_duration) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_max_duration <- bind_rows(TO_TC10_ic_max_duration, TO_TC12_ic_max_duration) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_max_duration = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_max_duration, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
geom_rect(aes(xmin = 0.505, xmax = 1.505, ymin = 19.94, ymax = 20.0),
fill = scales::alpha("red", 0.8)) +
geom_rect(aes(xmin = 1.505, xmax = 2.505, ymin = 5.97, ymax = 6.03),
fill = scales::alpha("red", 0.8)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_max_duration) +
scale_y_continuous(limits = c(0,20), breaks = seq(0,20,5)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Duration [s]", x="",
title = "Max duration: Eyes on ic after start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_max_duration <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_max_duration.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# 23_ET_TO_ic_1st_glance_duration_without_start #### -----------------------------------------------------
## subset subscales ##
TO_TC10_ic_1st_glance_duration_without_start <- data_23_TO %>%
select(Exp, VPNr, HMI, TC10_ic_1st_glance_duration_without_start) %>%
dplyr::rename(score = TC10_ic_1st_glance_duration_without_start) %>%
add_column(scale = "TC10", .after = "VPNr")
TO_TC12_ic_1st_glance_duration_without_start <- data_23_TO %>%
select(Exp, VPNr, HMI, TC12_ic_1st_glance_duration_without_start) %>%
dplyr::rename(score = TC12_ic_1st_glance_duration_without_start) %>%
add_column(scale = "TC12", .after = "VPNr")
## build subset ##
TO_ic_1st_glance_duration_without_start <- bind_rows(TO_TC10_ic_1st_glance_duration_without_start, TO_TC12_ic_1st_glance_duration_without_start) %>%
mutate(scale = factor(scale, levels = c("TC10", "TC12_ic"), ordered = TRUE))
labels_TO_ic_1st_glance_duration_without_start = c("RtI with\ntime budget", "RtI without\ntime budget")
p <- ggplot(TO_ic_1st_glance_duration_without_start, aes(x=scale, y=score, fill=HMI)) +
geom_rect(aes(xmin = 0.5, xmax = 1.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F8FAA0", 0.002)) +
geom_rect(aes(xmin = 1.5, xmax = 2.5, ymin = 0, ymax = 20),
fill = scales::alpha("#F59562", 0.002)) +
geom_rect(aes(xmin = 1.497, xmax = 1.503, ymin = -Inf, ymax = Inf),
fill = scales::alpha("#2F2F2F", 1)) +
geom_rect(aes(xmin = 0.505, xmax = 1.505, ymin = 19.94, ymax = 20.0),
fill = scales::alpha("red", 0.8)) +
geom_rect(aes(xmin = 1.505, xmax = 2.505, ymin = 5.97, ymax = 6.03),
fill = scales::alpha("red", 0.8)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_TO_ic_1st_glance_duration_without_start) +
scale_y_continuous(limits = c(0,20), breaks = seq(0,20,5)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Duration [s]", x="",
title = "Duration of first glance to ic after start of request to intervene") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.5, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#A2AD00", "#E37222","#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_23_ET_TO_ic_1st_glance_duration_without_start <- g
ggsave(filename = "data/results/figures/23_ET_TO_ic_1st_glance_duration_without_start.png", g,
width = 6, height = 6, dpi = 600, units = "in", device='png')
# #### remove not needed data ---------------------------------------------
rm(list=setdiff(ls(), c("data_all_AR", "data_all_TO", "data_12_AR", "data_23_AR", "data_12_TO", "data_23_TO",
"fun_mean", "fun_median", "mean_ML", "sd_ML", "skim_ML",
"plot_12_ET_AR_all", "plot_12_ET_AR_surt",
"plot_12_ET_TO_all_n_gazes_till_EB_or_TO", "plot_12_ET_TO_glance_at_start", "plot_12_ET_TO_glance_at_start_perc",
"plot_12_ET_TO_all_n_glances_after_start", "plot_12_ET_TO_all_total_duration",
"plot_12_ET_TO_all_mean_duration", "plot_12_ET_TO_all_max_duration",
"plot_12_ET_TO_all_1st_glance_duration_without_start",
"plot_12_ET_TO_ic_nth_gaze_to_ic_dot", "plot_12_ET_TO_ic_nth_gaze_to_ic_box",
"plot_12_ET_TO_ic_glance_allocation_time", "plot_12_ET_TO_ic_n_glances_after_start_dot", "plot_12_ET_TO_ic_n_glances_after_start_box",
"plot_12_ET_TO_ic_total_duration", "plot_12_ET_TO_ic_mean_duration", "plot_12_ET_TO_ic_max_duration",
"plot_12_ET_TO_ic_1st_glance_duration_without_start",
"plot_23_ET_AR_all", "plot_23_ET_AR_surt",
"plot_23_ET_TO_all_n_gazes_till_EB_or_TO", "plot_23_ET_TO_glance_at_start", "plot_23_ET_TO_glance_at_start_perc",
"plot_23_ET_TO_all_n_glances_after_start", "plot_23_ET_TO_all_total_duration",
"plot_23_ET_TO_all_mean_duration", "plot_23_ET_TO_all_max_duration",
"plot_23_ET_TO_all_1st_glance_duration_without_start",
"plot_23_ET_TO_ic_nth_gaze_to_ic_dot", "plot_23_ET_TO_ic_nth_gaze_to_ic_box",
"plot_23_ET_TO_ic_glance_allocation_time", "plot_23_ET_TO_ic_n_glances_after_start_dot", "plot_23_ET_TO_ic_n_glances_after_start_box",
"plot_23_ET_TO_ic_total_duration", "plot_23_ET_TO_ic_mean_duration", "plot_23_ET_TO_ic_max_duration",
"plot_23_ET_TO_ic_1st_glance_duration_without_start")))
