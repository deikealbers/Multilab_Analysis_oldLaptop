width = 9, height = 6, dpi = 300, units = "in", device='png')
# 123_SD_Experience  -----------------------------------------------------
## basic plot ##
p <- ggplot(data, aes(x=HMI, y=Experience, fill=HMI)) +
scale_y_continuous(limits = c(0,4), breaks = seq(0,4, 1),
labels = c("1 -\nnever",
"2 -\nless than\nonce a month",
"3 -\nseveral times\na month",
"4 -\nseveral times\na week",
"5 -\nevery day")) +
geom_violin(fill= "transparent") +
geom_dotplot(binaxis = 'y', stackdir = 'center',
stackratio=1.3, dotsize=0.13, binwidth = 0.5) +
facet_wrap(~Exp) +
scale_fill_manual("HMI", values = c("HC" = "#3070b3", "LC" = "#98C6EA")) +
labs(y="", x="",
title = "Experience: \n	How often do you drive a car?") +
stat_summary(fun = mean, geom="point",colour="black", size=2) +
stat_summary(fun.data = fun_mean, geom="text", vjust=2.3, hjust=0.5) +
stat_summary(fun = median, geom="point",colour="black", size = 4, shape = 4) +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11, face = "plain"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
panel.grid.major.x = element_blank(),
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.y=element_text(color = "black", size=9, face = "plain"),
legend.position = "none")
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_t <- which(grepl('strip-t', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222")
k <- 1
for (i in strip_t) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_Experience <- g
ggsave(filename = "data/results/figures/123_SD_Experience.png", g,
width = 9.75, height = 5, dpi = 300, units = "in", device='png')
# 123_SD_Mileage  -----------------------------------------------------
## basic plot ##
p <- ggplot(data, aes(x=HMI, y=Mileage, fill=HMI)) +
scale_y_continuous(limits = c(0,3), breaks = seq(0,3, 1),
labels = c("< 5.000 km",
"5.001 km -\n10.000 km",
"10.001 km -\n20.000 km",
">20.000 km"
)) +
geom_violin(fill= "transparent") +
geom_dotplot(binaxis = 'y', stackdir = 'center',
stackratio=1.3, dotsize=0.13, binwidth = 0.5) +
facet_wrap(~Exp) +
scale_fill_manual("HMI", values = c("HC" = "#3070b3", "LC" = "#98C6EA")) +
labs(y="", x="",
title = "Mileage: \nHow many kilometers have you driven in the last 12 months?") +
stat_summary(fun = mean, geom="point",colour="black", size=2) +
stat_summary(fun.data = fun_mean, geom="text", vjust=-1., hjust=0.5) +
stat_summary(fun = median, geom="point",colour="black", size = 4, shape = 4) +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11, face = "plain"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
panel.grid.major.x = element_blank(),
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.y=element_text(color = "black", size=9, face = "plain"),
legend.position = "none")
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_t <- which(grepl('strip-t', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222")
k <- 1
for (i in strip_t) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_Mileage <- g
ggsave(filename = "data/results/figures/123_SD_Mileage.png", g,
width = 9.75, height = 5, dpi = 300, units = "in", device='png')
# 123_SD_Knowledge  -----------------------------------------------------
## basic plot ##
p <- ggplot(data, aes(x=HMI, y=Knowledge, fill=HMI)) +
scale_y_continuous(limits = c(0,4), breaks = seq(0,4, 1),
labels = c("0 - no\nknowledge",
"1",
"2",
"3",
"4 -\nexpert"
)) +
geom_violin(fill= "transparent") +
geom_dotplot(binaxis = 'y', stackdir = 'center',
stackratio=1.3, dotsize=0.13, binwidth = 0.5) +
facet_wrap(~Exp) +
scale_fill_manual("HMI", values = c("HC" = "#3070b3", "LC" = "#98C6EA")) +
labs(y="", x="",
title = "Prior Knowledge: \nDo you have prior knowledge in the field of automated driving?") +
stat_summary(fun = mean, geom="point",colour="black", size=2) +
stat_summary(fun.data = fun_mean, geom="text", vjust=-1.3, hjust=0.5) +
stat_summary(fun = median, geom="point",colour="black", size = 4, shape = 4) +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11, face = "plain"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
panel.grid.major.x = element_blank(),
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.y=element_text(color = "black", size=9, face = "plain"),
legend.position = "none")
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_t <- which(grepl('strip-t', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222")
k <- 1
for (i in strip_t) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_Knowledge <- g
ggsave(filename = "data/results/figures/123_SD_Knowledge.png", g,
width = 9.75, height = 5, dpi = 300, units = "in", device='png')
# 123_SD_FAS -----------------------------------------------------------
## subset subscales ##
FAS_CC <- data %>%
select(Exp, VPNr, HMI, FAS.CC) %>%
rename(score = FAS.CC) %>%
add_column(scale = "FAS_CC", .after = "VPNr")
FAS_ACC <- data %>%
select(Exp, VPNr, HMI, FAS.ACC) %>%
rename(score = FAS.ACC) %>%
add_column(scale = "FAS_ACC", .after = "VPNr")
FAS_LKA <- data %>%
select(Exp, VPNr, HMI, FAS.LKA) %>%
rename(score = FAS.LKA) %>%
add_column(scale = "FAS_LKA", .after = "VPNr")
FAS_NoFAS <- data %>%
select(Exp, VPNr, HMI, FAS.NoFAS) %>%
rename(score = FAS.NoFAS) %>%
add_column(scale = "FAS_NoFAS", .after = "VPNr")
## build subsets ##
FAS <- bind_rows(FAS_CC, FAS_ACC, FAS_LKA, FAS_NoFAS) %>%
mutate(scale = factor(scale, levels = c("FAS_CC", "FAS_ACC", "FAS_LKA", "FAS_NoFAS"), ordered = TRUE))
FAS_perc <- FAS %>%
select(-c(VPNr)) %>%
group_by(Exp, HMI, scale) %>%
skim_ML() %>%
select(Exp, HMI, scale, numeric.mean) %>%
rename(mean = numeric.mean)
## lables ##
labels_FAS = c("CC", "ACC", "LKA", "No FAS")
## n ##
p <- ggplot(FAS, aes(x=scale, y = score, fill=HMI)) +
geom_bar(stat = "identity", width = 0.7) +
scale_x_discrete(labels = labels_FAS) +
scale_y_continuous(limits = c(0,30), breaks = seq(0,30, 5)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Familiarity with ADAS [n]", x="",
title = "Which driver assistance systems do you already have experience with?") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.8, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222", "#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_FAS <- g
ggsave(filename = "data/results/figures/123_SD_FAS.png", g,
width = 15, height = 6, dpi = 600, units = "in", device='png')
## Percentage ##
p <- ggplot(FAS_perc, aes(x=scale, y = mean*100, fill=HMI)) +
geom_bar(stat = "identity", width = 0.7) +
scale_x_discrete(labels = labels_FAS) +
scale_y_continuous(limits = c(0,100), breaks = seq(0,100, 20)) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="Familiarity with ADAS [%]", x="",
title = "Which driver assistance systems do you already have experience with?") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=0, vjust=.88, hjust=0.8, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222", "#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_FAS_perc <- g
ggsave(filename = "data/results/figures/123_SD_FAS_perc.png", g,
width = 15, height = 6, dpi = 600, units = "in", device='png')
# 123_SD_Oft_box -----------------------------------------------------------
## subset subscales ##
Oft_CC <- data %>%
select(Exp, VPNr, HMI, OftCC) %>%
rename(score = OftCC) %>%
add_column(scale = "Oft_CC", .after = "VPNr")
Oft_ACC <- data %>%
select(Exp, VPNr, HMI, OftACC) %>%
rename(score = OftACC) %>%
add_column(scale = "Oft_ACC", .after = "VPNr")
Oft_LKA <- data %>%
select(Exp, VPNr, HMI, OftLKA) %>%
rename(score = OftLKA) %>%
add_column(scale = "Oft_LKA", .after = "VPNr")
## build subset ##
Oft <- bind_rows(Oft_CC, Oft_ACC, Oft_LKA) %>%
mutate(scale = factor(scale, levels = c("Oft_CC", "Oft_ACC", "Oft_LKA"), ordered = TRUE))
## lables ##
labels_Oft = c("CC", "ACC", "LKA")
p <- ggplot(Oft, aes(x=scale, y=score, fill=HMI)) +
stat_boxplot(geom ='errorbar', width = 0.3, lwd=0.2) +
geom_boxplot(outlier.shape = 21, lwd=0.2, outlier.size = 0.7) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
scale_x_discrete(labels = labels_Oft) +
scale_y_continuous(limits = c(0,5), breaks = seq(0,5,1),
labels = c("never", "seldom", "every month", "every week", "every day", "several times\na day")) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="", x="",
title = "How often do you use the system ...") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=30, vjust=.88, hjust=0.8, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222", "#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_Oft_box <- g
ggsave(filename = "data/results/figures/123_SD_Oft_box.png", g,
width = 15, height = 6, dpi = 600, units = "in", device='png')
# 123_SD_Oft_dot -----------------------------------------------------------
## subset subscales ##
Oft_CC <- data %>%
select(Exp, VPNr, HMI, OftCC) %>%
rename(score = OftCC) %>%
add_column(scale = "Oft_CC", .after = "VPNr")
Oft_ACC <- data %>%
select(Exp, VPNr, HMI, OftACC) %>%
rename(score = OftACC) %>%
add_column(scale = "Oft_ACC", .after = "VPNr")
Oft_LKA <- data %>%
select(Exp, VPNr, HMI, OftLKA) %>%
rename(score = OftLKA) %>%
add_column(scale = "Oft_LKA", .after = "VPNr")
## build subset ##
Oft <- bind_rows(Oft_CC, Oft_ACC, Oft_LKA) %>%
mutate(scale = factor(scale, levels = c("Oft_CC", "Oft_ACC", "Oft_LKA"), ordered = TRUE))
## lables ##
labels_Oft = c("CC", "ACC", "LKA")
p <- ggplot(Oft, aes(x=scale, y=score, fill=HMI)) +
geom_violin(fill= "transparent") +
geom_dotplot(binaxis = 'y', stackdir = 'center',
stackratio=1.1, dotsize=0.35, binwidth = 0.5) +
stat_summary(fun = mean, geom = "point" , colour="black", size=1, shape = 16) +
stat_summary(fun = median, geom="point",colour="black", size = 4, shape = 4) +
scale_x_discrete(labels = labels_Oft) +
scale_y_continuous(limits = c(0,5), breaks = seq(0,5,1),
labels = c("never", "seldom", "every month", "every week", "every day", "several times\na day")) +
facet_grid(HMI ~ Exp) +
scale_fill_manual(values = c("#3070b3", "#98C6EA")) +
labs(y="", x="",
title = "How often do you use the system ...") +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
legend.position = "none",
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.x=element_text(color = "black", size=9, angle=30, vjust=.88, hjust=0.8, face = "plain"),
axis.text.y=element_text(color = "black", size=9, face = "plain"))
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222", "#3070b3", "#98C6EA")
k <- 1
for (i in strip_both) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_Oft_dot <- g
ggsave(filename = "data/results/figures/123_SD_Oft_dot.png", g,
width = 15, height = 6, dpi = 600, units = "in", device='png')
# 123_SD_Weather  -----------------------------------------------------
## basic plot ##
p <- ggplot(data, aes(x=HMI, y=Weather, fill=HMI)) +
scale_y_continuous(limits = c(0,3), breaks = seq(0,3, 1),
labels = c("sunny,\nblue sky",
"lightly\nclouded",
"heavily\nclouded",
"light\nrain"
)) +
geom_violin(fill= "transparent") +
geom_dotplot(binaxis = 'y', stackdir = 'center',
stackratio=1.3, dotsize=0.13, binwidth = 0.5) +
facet_wrap(~Exp) +
scale_fill_manual("HMI", values = c("HC" = "#3070b3", "LC" = "#98C6EA")) +
labs(y="", x="",
title = "Weather conditions at beginning of experiment") +
stat_summary(fun = mean, geom="point",colour="black", size=2) +
stat_summary(fun.data = fun_mean, geom="text", vjust=-1.3, hjust=0.5) +
stat_summary(fun = median, geom="point",colour="black", size = 4, shape = 4) +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11, face = "plain"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
panel.grid.major.x = element_blank(),
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.y=element_text(color = "black", size=9, face = "plain"),
legend.position = "none")
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_t <- which(grepl('strip-t', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222")
k <- 1
for (i in strip_t) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_Weather <- g
ggsave(filename = "data/results/figures/123_SD_Weather.png", g,
width = 9.75, height = 5, dpi = 300, units = "in", device='png')
# 123_SD_Light  -----------------------------------------------------
## basic plot ##
p <- ggplot(data, aes(x=HMI, y=Light, fill=HMI)) +
scale_y_continuous(limits = c(0, 2), breaks = seq(0, 2, 1),
labels = c("very bright,\nblinding",
"bright",
"gloomy,\ndusky"
)) +
geom_violin(fill= "transparent") +
geom_dotplot(binaxis = 'y', stackdir = 'center',
stackratio=1.1, dotsize=0.08, binwidth = 0.5) +
facet_wrap(~Exp) +
scale_fill_manual("HMI", values = c("HC" = "#3070b3", "LC" = "#98C6EA")) +
labs(y="", x="",
title = "Light conditions at beginning of experiment") +
stat_summary(fun = mean, geom="point",colour="black", size=2) +
stat_summary(fun.data = fun_mean, geom="text", vjust=1.3, hjust=0.5) +
stat_summary(fun = median, geom="point",colour="black", size = 4, shape = 4) +
theme_bw() +
theme(text=element_text(family = "sans", color="black", size=11, face = "plain"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(size = 0.2),
panel.grid.major.x = element_blank(),
plot.background = element_rect(fill = "transparent",
colour = NA_character_),
axis.text.y=element_text(color = "black", size=9, face = "plain"),
legend.position = "none")
p
## change color of facet box (code by CharlotteWoolley , 17 May 2018: https://github.com/tidyverse/ggplot2/issues/2096)
g <- ggplot_gtable(ggplot_build(p))
strip_t <- which(grepl('strip-t', g$layout$name))
fills <- c("#DAD7CB", "#A2AD00", "#E37222")
k <- 1
for (i in strip_t) {
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
grid.draw(g)
plot_123_SD_Light <- g
ggsave(filename = "data/results/figures/123_SD_Light.png", g,
width = 12.75, height = 5, dpi = 300, units = "in", device='png')
#### script for anova testing of usability questionnaires ####
# builds on script 04_Lime_AutLvl_UsabQ_add_shortI+ER-scores.R
# https://statsandr.com/blog/anova-in-r/#introduction
# SUS_score
# UMUX_score
# Trust
# Acceptance
#### readme ####
# script is based on article "Cumulative Link Models for Ordinal Regression with the R Package ordinal" by Christensen
# and https://rcompanion.org/handbook/G_11.html
#### preparations ####
rm(list = ls())
library(tidyverse)
library(car)
library(ordinal)
library(DescTools)
library(tibble)
# library(compute.es)
# library(ggplot2)
# library(multcomp)
# library(pastecs)
# library(reshape)
# library(WRS)
# library(DescTools)
# library(afex)
setwd("~/R/Multilab_Analysis")
#### import data ####
# Read in files
data_all <- read.csv("data/preprocessed/Lime+AutLvl+UsabQ+shortI+ER_all.csv", encoding = "UTF-8")
# manipulate data sets
data_Q <- data_all %>%
mutate(Exp = factor(Exp, ordered = TRUE, levels = c("1", "2", "3"))) %>%
mutate(HMI = factor(HMI, ordered = TRUE, levels = c("LC", "HC"))) %>%
select(c(Exp, HMI,
SUS_score, UMUX_score,
starts_with("UEQ_"),
Trust, Acceptance)) %>%
mutate(SUS_score = factor(SUS_score, ordered = TRUE)) %>%
mutate(UMUX_score = factor(UMUX_score, ordered = TRUE)) %>%
mutate(UEQ_Attractiveness = factor(UEQ_Attractiveness, ordered = TRUE)) %>%
mutate(UEQ_Perspicuity = factor(UEQ_Perspicuity, ordered = TRUE)) %>%
mutate(UEQ_Efficiency = factor(UEQ_Efficiency, ordered = TRUE)) %>%
mutate(UEQ_Dependability = factor(UEQ_Dependability, ordered = TRUE)) %>%
mutate(UEQ_Novelty = factor(UEQ_Novelty, ordered = TRUE)) %>%
mutate(UEQ_Stimulation = factor(UEQ_Stimulation, ordered = TRUE)) %>%
mutate(Trust = factor(Trust, ordered = TRUE)) %>%
mutate(Acceptance = factor(Acceptance, ordered = TRUE))
# build subsets
data_12 <- data_Q %>%
filter(Exp == '1' | Exp == '2')
data_23 <- data_Q %>%
filter(Exp == '2' | Exp == '3')
#### clm table names ####
c_coef <- c("factor_1", "factor_2", "factor_3",
"est_1", "est_2", "est_3",
"sterr_1", "sterr_2", "sterr_3",
"z_1", "z_2", "z_3",
"p_1", "p_2", "p_3")
c_aov <- c("aov_df_1", "aov_df_2", "aov_df_3",
"aov_ChiSq_1", "aov_ChiSq_2", "aov_ChiSq_3",
"aov_p_1", "aov_p_2", "aov_p_3")
################################## ________ CLM 12 ________ ########################################
#### clm 12 SUS_score ####
variable <- "SUS_score"
data <- "12"
# model
clm_12 = clm(SUS_score ~ Exp + HMI + Exp:HMI,
data = data_12)
# extract coefficient table with parameter estimates, standard errors and
# Wald based p values for tests of the parameters being zero.
clm_12_sum_coef <- data.frame(summary(clm_12)[["coefficients"]])
clm_12_sum_coef_df <- tibble::rownames_to_column(clm_12_sum_coef, "factor")
clm_12_coef <- clm_12_sum_coef_df %>%
filter(factor == "Exp.L" | factor == "HMI.L" | factor == "Exp.L:HMI.L")
tab_clm_12_coef <- data.frame(matrix(unlist(clm_12_coef), nrow=1, byrow=TRUE),stringsAsFactors=FALSE)
names(tab_clm_12_coef) <- c_coef
# anova: analysis of deviance (ANODE) tables also based on Wald Chi-Sq tests
# and provides tables with type I, II and III hypothesis tests using the SAS definition
clm_12_aov <- anova(clm_12, type = 3)
tab_clm_12_aov <- data.frame(matrix(unlist(clm_12_aov), nrow=1, byrow=TRUE),stringsAsFactors=FALSE)
names(tab_clm_12_aov) <- c_aov
# build table clm+aov
tab_clm_12 <- cbind(variable, data, tab_clm_12_coef, tab_clm_12_aov)
## build results table (first test different)
CLM_results_table <- tab_clm_12
clm_12_aov
clm_12
